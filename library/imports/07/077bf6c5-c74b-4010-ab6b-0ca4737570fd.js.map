{"version":3,"sources":["assets\\script\\board\\update.js"],"names":["cc","Class","Component","properties","movecodelist","type","Label","place","Node","redchess","blackchess","deadredchess","deadblackchess","map","movelist","onLoad","updateall","start","update","dt","redc","getChildren","blackc","getComponent","then","data","j","length","name","x","y","pauseSystemEvents","resumeSystemEvents","k","JSON","stringify","push","string","console","log","countreddead","setScale","chesssize","parent","countblackdead"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n// import * as io from \"socket.io-client\";\r\n// let socket = io.connect('http://localhost:3000/');\\\r\nimport {\r\n  receivedchessPosition,\r\n  receiveddeadchess,\r\n  sendchessPosition,\r\n} from \"../socket_connection\";\r\n\r\ncc.Class({\r\n  extends: cc.Component,\r\n\r\n  properties: {\r\n    movecodelist: {\r\n      default: null,\r\n      type: cc.Label,\r\n    },\r\n    place: {\r\n      default: null,\r\n      type: cc.Node,\r\n    },\r\n    redchess: {\r\n      default: null,\r\n      type: cc.Node,\r\n    },\r\n    blackchess: {\r\n      default: null,\r\n      type: cc.Node,\r\n    },\r\n    deadredchess: {\r\n      default: null,\r\n      type: cc.Node,\r\n    },\r\n    deadblackchess: {\r\n      default: null,\r\n      type: cc.Node,\r\n    },\r\n    map: {\r\n      default: null,\r\n      type: cc.Node,\r\n    },\r\n    movelist: [],\r\n  },\r\n\r\n  onLoad() {},\r\n  updateall() {\r\n    // let map = this.map.getComponent(\"boardinfo\");\r\n    // list += JSON.stringify(map.movecode[map.movecode.length - 1]) + \"\\n\";\r\n  },\r\n  start() {},\r\n  update(dt = 10000) {\r\n    var redchess = this.redchess;\r\n    var redc = redchess.getChildren();\r\n    var blackchess = this.blackchess;\r\n    var blackc = blackchess.getChildren();\r\n    let map = this.map.getComponent(\"boardinfo\");\r\n    let deadredchess = this.deadredchess;\r\n    let deadblackchess = this.deadblackchess;\r\n    var movecodelist = this.movecodelist;\r\n\r\n    receivedchessPosition().then((data) => {\r\n      for (var j = 0; j < redc.length; j++) {\r\n        if (redc[j].name == data[data.length - 1].name) {\r\n          redc[j].x = data[data.length - 1].x;\r\n          redc[j].y = data[data.length - 1].y;\r\n          redchess.pauseSystemEvents(true);\r\n          blackchess.resumeSystemEvents(true);\r\n          break;\r\n        }\r\n      }\r\n      for (var k = 0; k < blackc.length; k++) {\r\n        if (blackc[k].name == data[data.length - 1].name) {\r\n          blackc[k].x = data[data.length - 1].x;\r\n          blackc[k].y = data[data.length - 1].y;\r\n          blackchess.pauseSystemEvents(true);\r\n          redchess.resumeSystemEvents(true);\r\n          break;\r\n        }\r\n      }\r\n      if (  \r\n        this.movelist.length == 0 ||\r\n        this.movelist[this.movelist.length - 1] !==\r\n          JSON.stringify(data[data.length - 1])\r\n      ) {\r\n        this.movelist.push(JSON.stringify(data[data.length - 1]));\r\n      }\r\n      movecodelist.string = this.movelist;\r\n    })\r\n    .catch(function () {\r\n      console.log(\"Promise Rejected\");\r\n    });\r\n    receiveddeadchess().then((data) => {\r\n      for (var j = 0; j < redc.length; j++) {\r\n        if (redc[j].name == data.name) {\r\n          map.countreddead++;\r\n          redc[j].setScale(0.8, 0.8);\r\n          redc[j].x = 0;\r\n          redc[j].y = -30 - map.countreddead * (map.chesssize / 2);\r\n          redc[j].pauseSystemEvents(true);\r\n          redc[j].parent = deadredchess;\r\n        }\r\n      }\r\n      for (var k = 0; k < blackc.length; k++) {\r\n        if (blackc[k].name == data.name) {\r\n          map.countblackdead++;\r\n          blackc[k].setScale(0.8, 0.8);\r\n          blackc[k].x = 0;\r\n          blackc[k].y = -30 - map.countblackdead * (map.chesssize / 2);\r\n          blackc[k].pauseSystemEvents(true);\r\n          blackc[k].parent = deadblackchess;\r\n        }\r\n      }\r\n    }).catch(function () {\r\n      console.log(\"Promise Rejected\");\r\n    });\r\n  },\r\n});\r\n"]}