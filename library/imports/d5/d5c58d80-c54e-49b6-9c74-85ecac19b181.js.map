{"version":3,"sources":["assets\\script\\board\\chess\\redchess\\bishopred.js"],"names":["cc","Class","Component","properties","place","type","Node","redchess","blackchess","map","showpossiblemove","getComponent","touchmove","posmove","getChildren","redc","blackc","parent","self","uid","then","data","fetch","method","headers","Accept","response","json","console","log","i","length","active","pauseSystemEvents","y","redriver","x","node","s","j","k","setScale","scale","redtouchmove","start"],"mappings":";;;;;;AAOA;;AAPA;AACA;AACA;AACA;AACA;AACA;AAIAA,EAAE,CAACC,KAAH,CAAS;AACP,aAASD,EAAE,CAACE,SADL;AAGPC,EAAAA,UAAU,EAAE;AACVC,IAAAA,KAAK,EAAE;AACL,iBAAS,IADJ;AAELC,MAAAA,IAAI,EAAEL,EAAE,CAACM;AAFJ,KADG;AAKVC,IAAAA,QAAQ,EAAE;AACR,iBAAS,IADD;AAERF,MAAAA,IAAI,EAAEL,EAAE,CAACM;AAFD,KALA;AASVE,IAAAA,UAAU,EAAE;AACV,iBAAS,IADC;AAEVH,MAAAA,IAAI,EAAEL,EAAE,CAACM;AAFC,KATF;AAaVG,IAAAA,GAAG,EAAE;AACH,iBAAS,IADN;AAEHJ,MAAAA,IAAI,EAAEL,EAAE,CAACM;AAFN;AAbK,GAHL;AAqBPI,EAAAA,gBArBO,8BAqBY;AACjB,QAAID,GAAG,GAAG,KAAKA,GAAL,CAASE,YAAT,CAAsB,WAAtB,CAAV;AACA,QAAIC,SAAS,GAAG,KAAKH,GAAL,CAASE,YAAT,CAAsB,WAAtB,CAAhB;AACA,QAAIP,KAAK,GAAG,KAAKA,KAAjB;AACA,QAAIS,OAAO,GAAGT,KAAK,CAACU,WAAN,EAAd;AACA,QAAIP,QAAQ,GAAG,KAAKA,QAApB;AACA,QAAIQ,IAAI,GAAGR,QAAQ,CAACO,WAAT,EAAX;AACA,QAAIN,UAAU,GAAG,KAAKA,UAAtB;AACA,QAAIQ,MAAM,GAAGR,UAAU,CAACM,WAAX,EAAb;AACAC,IAAAA,IAAI,CAACE,MAAL,GAAcb,KAAd;AACAY,IAAAA,MAAM,CAACC,MAAP,GAAgBb,KAAhB;AACAc,IAAAA,IAAI,GAAG,IAAP;AAEA,QAAIC,GAAG,GAAGA,GAAV;AACA,6CAAiBC,IAAjB,CAAsB,UAACC,IAAD,EAAU;AAC9BC,MAAAA,KAAK,CAAC,4DAA4DD,IAA7D,EAAmE;AACtEE,QAAAA,MAAM,EAAE,KAD8D;AAEtEC,QAAAA,OAAO,EAAE;AACPC,UAAAA,MAAM,EAAE,kBADD;AAEP,0BAAgB;AAFT;AAF6D,OAAnE,CAAL,CAOGL,IAPH,CAOQ,UAACM,QAAD;AAAA,eAAcA,QAAQ,CAACC,IAAT,EAAd;AAAA,OAPR,EAQGP,IARH,CAQQ,UAACC,IAAD,EAAU;AACdO,QAAAA,OAAO,CAACC,GAAR,CAAYR,IAAZ;AACA,iDAAiBD,IAAjB,CAAsB,UAACC,IAAD,EAAU;AAC9B,cAAIA,IAAI,IAAIF,GAAZ,EAAiB;AACfS,YAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBV,GAAtB;AACD;AACF,SAJD;AAKD,OAfH;AAgBD,KAjBD,EAdiB,CAiCjB;;AACA,SAAK,IAAIW,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGjB,OAAO,CAACkB,MAA5B,EAAoCD,CAAC,EAArC,EAAyC;AACvC,UAAIjB,OAAO,CAACiB,CAAD,CAAP,CAAWE,MAAX,IAAqB,IAAzB,EAA+B;AAC7BnB,QAAAA,OAAO,CAACiB,CAAD,CAAP,CAAWE,MAAX,GAAoB,KAApB;AACD;AACF,KAtCgB,CAuCjB;;;AACAxB,IAAAA,UAAU,CAACyB,iBAAX,CAA6B,IAA7B,EAxCiB,CAyCjB;;AACA,SAAK,IAAIH,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGjB,OAAO,CAACkB,MAA5B,EAAoCD,CAAC,EAArC,EAAyC;AACvC,UAAIjB,OAAO,CAACiB,CAAD,CAAP,CAAWI,CAAX,IAAgBzB,GAAG,CAAC0B,QAAxB,EAAkC;AAChC;AACA,YACEtB,OAAO,CAACiB,CAAD,CAAP,CAAWM,CAAX,IAAgBlB,IAAI,CAACmB,IAAL,CAAUD,CAAV,GAAc3B,GAAG,CAAC6B,CAAJ,GAAQ,CAAtC,IACAzB,OAAO,CAACiB,CAAD,CAAP,CAAWI,CAAX,IAAgBhB,IAAI,CAACmB,IAAL,CAAUH,CAAV,GAAczB,GAAG,CAAC6B,CAAJ,GAAQ,CAFxC,EAGE;AACAzB,UAAAA,OAAO,CAACiB,CAAD,CAAP,CAAWE,MAAX,GAAoB,IAApB;;AACA,eAAK,IAAIO,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGxB,IAAI,CAACgB,MAAzB,EAAiCQ,CAAC,EAAlC,EAAsC;AACpC,gBACExB,IAAI,CAACwB,CAAD,CAAJ,CAAQH,CAAR,IAAalB,IAAI,CAACmB,IAAL,CAAUD,CAAV,GAAc3B,GAAG,CAAC6B,CAA/B,IACAvB,IAAI,CAACwB,CAAD,CAAJ,CAAQL,CAAR,IAAahB,IAAI,CAACmB,IAAL,CAAUH,CAAV,GAAczB,GAAG,CAAC6B,CAFjC,EAGE;AACAzB,cAAAA,OAAO,CAACiB,CAAD,CAAP,CAAWE,MAAX,GAAoB,KAApB;AACD;AACF;;AACD,eAAK,IAAIQ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGxB,MAAM,CAACe,MAA3B,EAAmCS,CAAC,EAApC,EAAwC;AACtC,gBACExB,MAAM,CAACwB,CAAD,CAAN,CAAUJ,CAAV,IAAelB,IAAI,CAACmB,IAAL,CAAUD,CAAV,GAAc3B,GAAG,CAAC6B,CAAjC,IACAtB,MAAM,CAACwB,CAAD,CAAN,CAAUN,CAAV,IAAehB,IAAI,CAACmB,IAAL,CAAUH,CAAV,GAAczB,GAAG,CAAC6B,CAFnC,EAGE;AACAzB,cAAAA,OAAO,CAACiB,CAAD,CAAP,CAAWE,MAAX,GAAoB,KAApB;AACD;AACF;AACF,SAvB+B,CAwBhC;;;AACA,YACEnB,OAAO,CAACiB,CAAD,CAAP,CAAWM,CAAX,IAAgBlB,IAAI,CAACmB,IAAL,CAAUD,CAAV,GAAc3B,GAAG,CAAC6B,CAAJ,GAAQ,CAAtC,IACAzB,OAAO,CAACiB,CAAD,CAAP,CAAWI,CAAX,IAAgBhB,IAAI,CAACmB,IAAL,CAAUH,CAAV,GAAczB,GAAG,CAAC6B,CAAJ,GAAQ,CAFxC,EAGE;AACAzB,UAAAA,OAAO,CAACiB,CAAD,CAAP,CAAWE,MAAX,GAAoB,IAApB;;AACA,eAAK,IAAIO,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGxB,IAAI,CAACgB,MAAzB,EAAiCQ,CAAC,EAAlC,EAAsC;AACpC,gBACExB,IAAI,CAACwB,CAAD,CAAJ,CAAQH,CAAR,IAAalB,IAAI,CAACmB,IAAL,CAAUD,CAAV,GAAc3B,GAAG,CAAC6B,CAA/B,IACAvB,IAAI,CAACwB,CAAD,CAAJ,CAAQL,CAAR,IAAahB,IAAI,CAACmB,IAAL,CAAUH,CAAV,GAAczB,GAAG,CAAC6B,CAFjC,EAGE;AACAzB,cAAAA,OAAO,CAACiB,CAAD,CAAP,CAAWE,MAAX,GAAoB,KAApB;AACD;AACF;;AACD,eAAK,IAAIQ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGxB,MAAM,CAACe,MAA3B,EAAmCS,CAAC,EAApC,EAAwC;AACtC,gBACExB,MAAM,CAACwB,CAAD,CAAN,CAAUJ,CAAV,IAAelB,IAAI,CAACmB,IAAL,CAAUD,CAAV,GAAc3B,GAAG,CAAC6B,CAAjC,IACAtB,MAAM,CAACwB,CAAD,CAAN,CAAUN,CAAV,IAAehB,IAAI,CAACmB,IAAL,CAAUH,CAAV,GAAczB,GAAG,CAAC6B,CAFnC,EAGE;AACAzB,cAAAA,OAAO,CAACiB,CAAD,CAAP,CAAWE,MAAX,GAAoB,KAApB;AACD;AACF;AACF,SA9C+B,CA+ChC;;;AACA,YACEnB,OAAO,CAACiB,CAAD,CAAP,CAAWM,CAAX,IAAgBlB,IAAI,CAACmB,IAAL,CAAUD,CAAV,GAAc3B,GAAG,CAAC6B,CAAJ,GAAQ,CAAtC,IACAzB,OAAO,CAACiB,CAAD,CAAP,CAAWI,CAAX,IAAgBhB,IAAI,CAACmB,IAAL,CAAUH,CAAV,GAAczB,GAAG,CAAC6B,CAAJ,GAAQ,CAFxC,EAGE;AACAzB,UAAAA,OAAO,CAACiB,CAAD,CAAP,CAAWE,MAAX,GAAoB,IAApB;;AACA,eAAK,IAAIO,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGxB,IAAI,CAACgB,MAAzB,EAAiCQ,CAAC,EAAlC,EAAsC;AACpC,gBACExB,IAAI,CAACwB,CAAD,CAAJ,CAAQH,CAAR,IAAalB,IAAI,CAACmB,IAAL,CAAUD,CAAV,GAAc3B,GAAG,CAAC6B,CAA/B,IACAvB,IAAI,CAACwB,CAAD,CAAJ,CAAQL,CAAR,IAAahB,IAAI,CAACmB,IAAL,CAAUH,CAAV,GAAczB,GAAG,CAAC6B,CAFjC,EAGE;AACAzB,cAAAA,OAAO,CAACiB,CAAD,CAAP,CAAWE,MAAX,GAAoB,KAApB;AACD;AACF;;AACD,eAAK,IAAIQ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGxB,MAAM,CAACe,MAA3B,EAAmCS,CAAC,EAApC,EAAwC;AACtC,gBACExB,MAAM,CAACwB,CAAD,CAAN,CAAUJ,CAAV,IAAelB,IAAI,CAACmB,IAAL,CAAUD,CAAV,GAAc3B,GAAG,CAAC6B,CAAjC,IACAtB,MAAM,CAACwB,CAAD,CAAN,CAAUN,CAAV,IAAehB,IAAI,CAACmB,IAAL,CAAUH,CAAV,GAAczB,GAAG,CAAC6B,CAFnC,EAGE;AACAzB,cAAAA,OAAO,CAACiB,CAAD,CAAP,CAAWE,MAAX,GAAoB,KAApB;AACD;AACF;AACF,SArE+B,CAsEhC;;;AACA,YACEnB,OAAO,CAACiB,CAAD,CAAP,CAAWM,CAAX,IAAgBlB,IAAI,CAACmB,IAAL,CAAUD,CAAV,GAAc3B,GAAG,CAAC6B,CAAJ,GAAQ,CAAtC,IACAzB,OAAO,CAACiB,CAAD,CAAP,CAAWI,CAAX,IAAgBhB,IAAI,CAACmB,IAAL,CAAUH,CAAV,GAAczB,GAAG,CAAC6B,CAAJ,GAAQ,CAFxC,EAGE;AACAzB,UAAAA,OAAO,CAACiB,CAAD,CAAP,CAAWE,MAAX,GAAoB,IAApB;;AACA,eAAK,IAAIO,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGxB,IAAI,CAACgB,MAAzB,EAAiCQ,CAAC,EAAlC,EAAsC;AACpC,gBACExB,IAAI,CAACwB,CAAD,CAAJ,CAAQH,CAAR,IAAalB,IAAI,CAACmB,IAAL,CAAUD,CAAV,GAAc3B,GAAG,CAAC6B,CAA/B,IACAvB,IAAI,CAACwB,CAAD,CAAJ,CAAQL,CAAR,IAAahB,IAAI,CAACmB,IAAL,CAAUH,CAAV,GAAczB,GAAG,CAAC6B,CAFjC,EAGE;AACAzB,cAAAA,OAAO,CAACiB,CAAD,CAAP,CAAWE,MAAX,GAAoB,KAApB;AACD;AACF;;AACD,eAAK,IAAIQ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGxB,MAAM,CAACe,MAA3B,EAAmCS,CAAC,EAApC,EAAwC;AACtC,gBACExB,MAAM,CAACwB,CAAD,CAAN,CAAUJ,CAAV,IAAelB,IAAI,CAACmB,IAAL,CAAUD,CAAV,GAAc3B,GAAG,CAAC6B,CAAjC,IACAtB,MAAM,CAACwB,CAAD,CAAN,CAAUN,CAAV,IAAehB,IAAI,CAACmB,IAAL,CAAUH,CAAV,GAAczB,GAAG,CAAC6B,CAFnC,EAGE;AACAzB,cAAAA,OAAO,CAACiB,CAAD,CAAP,CAAWE,MAAX,GAAoB,KAApB;AACD;AACF;AACF,SA5F+B,CA6FhC;;;AACA,aAAK,IAAIO,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGxB,IAAI,CAACgB,MAAzB,EAAiCQ,CAAC,EAAlC,EAAsC;AACpC,cAAIxB,IAAI,CAACwB,CAAD,CAAJ,CAAQH,CAAR,IAAavB,OAAO,CAACiB,CAAD,CAAP,CAAWM,CAAxB,IAA6BrB,IAAI,CAACwB,CAAD,CAAJ,CAAQL,CAAR,IAAarB,OAAO,CAACiB,CAAD,CAAP,CAAWI,CAAzD,EAA4D;AAC1DrB,YAAAA,OAAO,CAACiB,CAAD,CAAP,CAAWE,MAAX,GAAoB,KAApB;AACD;AACF,SAlG+B,CAmGhC;;;AACA,aAAK,IAAIQ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGxB,MAAM,CAACe,MAA3B,EAAmCS,CAAC,EAApC,EAAwC;AACtC,cACExB,MAAM,CAACwB,CAAD,CAAN,CAAUJ,CAAV,IAAevB,OAAO,CAACiB,CAAD,CAAP,CAAWM,CAA1B,IACApB,MAAM,CAACwB,CAAD,CAAN,CAAUN,CAAV,IAAerB,OAAO,CAACiB,CAAD,CAAP,CAAWI,CAD1B,IAEArB,OAAO,CAACiB,CAAD,CAAP,CAAWE,MAAX,IAAqB,IAHvB,EAIE;AACAnB,YAAAA,OAAO,CAACiB,CAAD,CAAP,CAAWW,QAAX,CAAoBhC,GAAG,CAACiC,KAAxB,EAA+BjC,GAAG,CAACiC,KAAnC;AACD;AACF;AACF,OA9GsC,CA+GvC;;;AACA9B,MAAAA,SAAS,CAAC+B,YAAV,CAAuBb,CAAvB;AACD;AACF,GAjLM;AAmLPc,EAAAA,KAnLO,mBAmLC,CAAE,CAnLH,CAqLP;;AArLO,CAAT","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport { receivedroomID, receiveduserID } from \"../../../socket_connection\";\r\n\r\ncc.Class({\r\n  extends: cc.Component,\r\n\r\n  properties: {\r\n    place: {\r\n      default: null,\r\n      type: cc.Node,\r\n    },\r\n    redchess: {\r\n      default: null,\r\n      type: cc.Node,\r\n    },\r\n    blackchess: {\r\n      default: null,\r\n      type: cc.Node,\r\n    },\r\n    map: {\r\n      default: null,\r\n      type: cc.Node,\r\n    },\r\n  },\r\n  showpossiblemove() {\r\n    let map = this.map.getComponent(\"boardinfo\");\r\n    let touchmove = this.map.getComponent(\"touchmove\");\r\n    var place = this.place;\r\n    var posmove = place.getChildren();\r\n    var redchess = this.redchess;\r\n    var redc = redchess.getChildren();\r\n    var blackchess = this.blackchess;\r\n    var blackc = blackchess.getChildren();\r\n    redc.parent = place;\r\n    blackc.parent = place;\r\n    self = this;\r\n\r\n    var uid = uid;\r\n    receivedroomID().then((data) => {\r\n      fetch(\"fetch(https://chinese-chess-vnp.herokuapp.com/api/room/\" + data, {\r\n        method: \"GET\",\r\n        headers: {\r\n          Accept: \"application/json\",\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n      })\r\n        .then((response) => response.json())\r\n        .then((data) => {\r\n          console.log(data);\r\n          receiveduserID().then((data) => {\r\n            if (data == uid) {\r\n              console.log(\"uid p1\", uid);\r\n            }\r\n          });\r\n        });\r\n    });\r\n\r\n    //deactive before another click\r\n    for (var i = 0; i < posmove.length; i++) {\r\n      if (posmove[i].active == true) {\r\n        posmove[i].active = false;\r\n      }\r\n    }\r\n    //redturn\r\n    blackchess.pauseSystemEvents(true);\r\n    //logic move\r\n    for (var i = 0; i < posmove.length; i++) {\r\n      if (posmove[i].y <= map.redriver) {\r\n        //upright\r\n        if (\r\n          posmove[i].x == self.node.x + map.s * 2 &&\r\n          posmove[i].y == self.node.y + map.s * 2\r\n        ) {\r\n          posmove[i].active = true;\r\n          for (var j = 0; j < redc.length; j++) {\r\n            if (\r\n              redc[j].x == self.node.x + map.s &&\r\n              redc[j].y == self.node.y + map.s\r\n            ) {\r\n              posmove[i].active = false;\r\n            }\r\n          }\r\n          for (var k = 0; k < blackc.length; k++) {\r\n            if (\r\n              blackc[k].x == self.node.x + map.s &&\r\n              blackc[k].y == self.node.y + map.s\r\n            ) {\r\n              posmove[i].active = false;\r\n            }\r\n          }\r\n        }\r\n        //upleft\r\n        if (\r\n          posmove[i].x == self.node.x - map.s * 2 &&\r\n          posmove[i].y == self.node.y + map.s * 2\r\n        ) {\r\n          posmove[i].active = true;\r\n          for (var j = 0; j < redc.length; j++) {\r\n            if (\r\n              redc[j].x == self.node.x - map.s &&\r\n              redc[j].y == self.node.y + map.s\r\n            ) {\r\n              posmove[i].active = false;\r\n            }\r\n          }\r\n          for (var k = 0; k < blackc.length; k++) {\r\n            if (\r\n              blackc[k].x == self.node.x - map.s &&\r\n              blackc[k].y == self.node.y + map.s\r\n            ) {\r\n              posmove[i].active = false;\r\n            }\r\n          }\r\n        }\r\n        //downright\r\n        if (\r\n          posmove[i].x == self.node.x + map.s * 2 &&\r\n          posmove[i].y == self.node.y - map.s * 2\r\n        ) {\r\n          posmove[i].active = true;\r\n          for (var j = 0; j < redc.length; j++) {\r\n            if (\r\n              redc[j].x == self.node.x + map.s &&\r\n              redc[j].y == self.node.y - map.s\r\n            ) {\r\n              posmove[i].active = false;\r\n            }\r\n          }\r\n          for (var k = 0; k < blackc.length; k++) {\r\n            if (\r\n              blackc[k].x == self.node.x + map.s &&\r\n              blackc[k].y == self.node.y - map.s\r\n            ) {\r\n              posmove[i].active = false;\r\n            }\r\n          }\r\n        }\r\n        //downleft\r\n        if (\r\n          posmove[i].x == self.node.x - map.s * 2 &&\r\n          posmove[i].y == self.node.y - map.s * 2\r\n        ) {\r\n          posmove[i].active = true;\r\n          for (var j = 0; j < redc.length; j++) {\r\n            if (\r\n              redc[j].x == self.node.x - map.s &&\r\n              redc[j].y == self.node.y - map.s\r\n            ) {\r\n              posmove[i].active = false;\r\n            }\r\n          }\r\n          for (var k = 0; k < blackc.length; k++) {\r\n            if (\r\n              blackc[k].x == self.node.x - map.s &&\r\n              blackc[k].y == self.node.y - map.s\r\n            ) {\r\n              posmove[i].active = false;\r\n            }\r\n          }\r\n        }\r\n        //block other chess\r\n        for (var j = 0; j < redc.length; j++) {\r\n          if (redc[j].x == posmove[i].x && redc[j].y == posmove[i].y) {\r\n            posmove[i].active = false;\r\n          }\r\n        }\r\n        //hightlight killable\r\n        for (var k = 0; k < blackc.length; k++) {\r\n          if (\r\n            blackc[k].x == posmove[i].x &&\r\n            blackc[k].y == posmove[i].y &&\r\n            posmove[i].active == true\r\n          ) {\r\n            posmove[i].setScale(map.scale, map.scale);\r\n          }\r\n        }\r\n      }\r\n      //touchmove\r\n      touchmove.redtouchmove(i);\r\n    }\r\n  },\r\n\r\n  start() {},\r\n\r\n  // update (dt) {},\r\n});\r\n"]}