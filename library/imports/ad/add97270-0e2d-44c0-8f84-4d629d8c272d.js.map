{"version":3,"sources":["assets\\script\\board\\touchmove.js"],"names":["cc","Class","Component","properties","place","type","Node","redchess","blackchess","map","deadredchess","deadblackchess","movecodelist","updateall","redtouchmove","i","getComponent","posmove","getChildren","redc","blackc","parent","active","on","self","node","isChildOf","kill","k","length","x","y","name","movecode","then","data","console","log","push","xed","yed","table","pauseSystemEvents","setScale","off","reset","blacktouchmove","j","movecChijode","start","onLoad","update","dt"],"mappings":"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","sourceRoot":"/","sourcesContent":["// let socket = io(\"http://localhost:3000\", {transports : ['websocket'],\r\n//     query: {\r\n//       userId: 1,\r\n//       cc:\"cc\",\r\n//     },\r\n//   });\r\n\r\nimport {\r\n  receivedchessPosition,\r\n  sendchessPosition,\r\n  senddeadchess,\r\n  receiveddeadchess,\r\n  sendstate,\r\n} from \"../socket_connection\";\r\n\r\n// const { io } = require(\"socket.io-client\");\r\n// import * as io from \"socket.io-client\";\r\n// let socket = io.connect('http://localhost:3000/');\r\n//\r\ncc.Class({\r\n  extends: cc.Component,\r\n  properties: {\r\n    place: {\r\n      default: null,\r\n      type: cc.Node,\r\n    },\r\n    redchess: {\r\n      default: null,\r\n      type: cc.Node,\r\n    },\r\n    blackchess: {\r\n      default: null,\r\n      type: cc.Node,\r\n    },\r\n    map: {\r\n      default: null,\r\n      type: cc.Node,\r\n    },\r\n    deadredchess: {\r\n      default: null,\r\n      type: cc.Node,\r\n    },\r\n    deadblackchess: {\r\n      default: null,\r\n      type: cc.Node,\r\n    },\r\n    movecodelist: {\r\n      default: null,\r\n      type: cc.Node,\r\n    },\r\n    updateall: {\r\n      default: null,\r\n      type: cc.Node,\r\n    },\r\n    // socket: io.connect(\"http://localhost:3000\", { transports : ['websocket'] }),\r\n  },\r\n  redtouchmove(i) {\r\n    let updateall = this.updateall.getComponent(\"update\");\r\n    let map = this.map.getComponent(\"boardinfo\");\r\n    let deadblackchess = this.deadblackchess;\r\n    var place = this.place;\r\n    var posmove = place.getChildren();\r\n    var redchess = this.redchess;\r\n    var redc = redchess.getChildren();\r\n    var blackchess = this.blackchess;\r\n    var blackc = blackchess.getChildren();\r\n    redc.parent = place;\r\n    blackc.parent = place;\r\n\r\n    if (posmove[i].active == true) {\r\n      posmove[i].on(\r\n        \"touchstart\",\r\n        function () {\r\n          if (self.node.isChildOf(redchess)) {\r\n            var kill = 0;\r\n            for (var k = 0; k < blackc.length; k++) {\r\n              if (blackc[k].x == this.x && blackc[k].y == this.y) {\r\n                senddeadchess({\r\n                  name: blackc[k].name,\r\n                });\r\n                kill++;\r\n                sendchessPosition(map.movecode);\r\n                receivedchessPosition()\r\n                  .then((data) => {\r\n                    console.log(data);\r\n                    map.movecode = data;\r\n                    map.movecode.push({\r\n                      name: self.node.name,\r\n                      xed: self.node.x,\r\n                      yed: self.node.y,\r\n                      x: this.x,\r\n                      y: this.y,\r\n                    });\r\n                  })\r\n                  .then((data) => {\r\n                    console.table(map.movecode);\r\n                    sendchessPosition(map.movecode);\r\n                  });\r\n\r\n                // console.log(self.node.name, this.x, this.y);\r\n                // const data = receivedchessPosition();\r\n                // console.log(data);\r\n                redchess.pauseSystemEvents(true);\r\n                this.setScale(1, 1);\r\n                this.off(\"touchstart\", this.function, posmove[i]);\r\n                break;\r\n              }\r\n            }\r\n            if (kill == 0) {\r\n              sendchessPosition(map.movecode);\r\n              receivedchessPosition()\r\n                .then((data) => {\r\n                  map.movecode = data;\r\n                  map.movecode.push({\r\n                    name: self.node.name,\r\n                    xed: self.node.x,\r\n                    yed: self.node.y,\r\n                    x: this.x,\r\n                    y: this.y,\r\n                  });\r\n                })\r\n                .then((data) => {\r\n                  console.table(map.movecode);\r\n                  sendchessPosition(map.movecode);\r\n                });\r\n              this.setScale(1, 1);\r\n              this.off(\"touchstart\", this.function, posmove[i]);\r\n            }\r\n          }\r\n          for (var reset = 0; reset < posmove.length; reset++) {\r\n            posmove[reset].setScale(1, 1);\r\n            posmove[reset].active = false;\r\n          }\r\n        },\r\n        posmove[i]\r\n      );\r\n    }\r\n  },\r\n  blacktouchmove(i) {\r\n    let updateall = this.updateall.getComponent(\"update\");\r\n    let map = this.map.getComponent(\"boardinfo\");\r\n    let deadredchess = this.deadredchess;\r\n    var place = this.place;\r\n    var posmove = place.getChildren();\r\n    var redchess = this.redchess;\r\n    var redc = redchess.getChildren();\r\n    var blackchess = this.blackchess;\r\n    var blackc = blackchess.getChildren();\r\n    redc.parent = place;\r\n    blackc.parent = place;\r\n    if (posmove[i].active == true) {\r\n      posmove[i].on(\r\n        \"touchstart\",\r\n        function () {\r\n          if (self.node.isChildOf(blackchess)) {\r\n            var kill = 0;\r\n            for (var j = 0; j < redc.length; j++) {\r\n              if (redc[j].x == this.x && redc[j].y == this.y) {\r\n                senddeadchess({\r\n                  name: redc[j].name,\r\n                });\r\n\r\n                kill++;\r\n                sendchessPosition(map.movecode);\r\n                receivedchessPosition()\r\n                  .then((data) => {\r\n                    console.log(data);\r\n                    map.movecode = data;\r\n                    console.log(map.movecode);\r\n                    map.movecode.push({\r\n                      name: self.node.name,\r\n                      xed: self.node.x,\r\n                      yed: self.node.y,\r\n                      x: this.x,\r\n                      y: this.y,\r\n                    });\r\n                  })\r\n                  .then((data) => {\r\n                    console.table(map.movecode);\r\n                    sendchessPosition(map.movecChijode);\r\n                  });\r\n                this.setScale(1, 1);\r\n                this.off(\"touchstart\", this.function, posmove[i]);\r\n                break;\r\n              }\r\n            }\r\n            if (kill == 0) {\r\n              sendchessPosition(map.movecode);\r\n              receivedchessPosition()\r\n                .then((data) => {\r\n                  map.movecode = data;\r\n                  map.movecode.push({\r\n                    name: self.node.name,\r\n                    xed: self.node.x,\r\n                    yed: self.node.y,\r\n                    x: this.x,\r\n                    y: this.y,\r\n                  });\r\n                })\r\n                .then((data) => {\r\n                  console.table(map.movecode);\r\n                  sendchessPosition(map.movecode);\r\n                });\r\n              blackchess.pauseSystemEvents(true);\r\n              this.setScale(1, 1);\r\n              this.off(\"touchstart\", this.function, posmove[i]);\r\n            }\r\n          }\r\n          for (var reset = 0; reset < posmove.length; reset++) {\r\n            posmove[reset].setScale(1, 1);\r\n            posmove[reset].active = false;\r\n          }\r\n        },\r\n        posmove[i]\r\n      );\r\n    }\r\n  },\r\n  // newposition(name, x, y){\r\n  //     return 'name', x, y;\r\n  // },\r\n  start() {},\r\n  onLoad() {},\r\n  update(dt) {},\r\n});\r\n"]}