
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/script/board/update.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '077bfbFx0tAEKtrDKRzdXD9', 'update');
// script/board/update.js

"use strict";

var _axios_connection = require("../axios_connection");

var _socket_connection = require("../socket_connection");

cc.Class({
  "extends": cc.Component,
  properties: {
    movecodelist: {
      "default": null,
      type: cc.Label
    },
    place: {
      "default": null,
      type: cc.Node
    },
    redchess: {
      "default": null,
      type: cc.Node
    },
    blackchess: {
      "default": null,
      type: cc.Node
    },
    deadredchess: {
      "default": null,
      type: cc.Node
    },
    deadblackchess: {
      "default": null,
      type: cc.Node
    },
    map: {
      "default": null,
      type: cc.Node
    },
    movelist: [],
    rid: {
      "default": null,
      type: cc.Label
    }
  },
  onLoad: function onLoad() {},
  start: function start() {},
  update: function update(dt) {
    var _this = this;

    if (dt === void 0) {
      dt = 10000;
    }

    var PlayerInfo = cc.director.getScene().getChildByName("PlayerInfo").getComponent("PlayerInfo");
    var RoomInfos = cc.director.getScene().getChildByName("RoomInfos").getComponent("RoomInfos");
    var rid = RoomInfos.rid;
    var redchess = this.redchess;
    var redc = redchess.getChildren();
    var blackchess = this.blackchess;
    var blackc = blackchess.getChildren();
    var map = this.map.getComponent("boardinfo");
    var deadredchess = this.deadredchess;
    var deadblackchess = this.deadblackchess;
    var movecodelist = this.movecodelist;
    (0, _socket_connection.receivedchessPosition)().then(function (data) {
      console.log("dataname" + data.Name);

      for (var j = 0; j < redc.length; j++) {
        if (redc[j].name == data.Name) {
          //move chess
          cc.tween(redc[j]).delay(0.1).to(0.125, {
            position: cc.v2(data.Xed, data.Yed + 5),
            scale: 1.1
          }).delay(0.125).to(0.5, {
            position: cc.v2(data.X, data.Y + 15),
            scale: 1.3
          }, {
            easing: "backIn"
          }).delay(0.125).to(0.125, {
            position: cc.v2(data.X, data.Y),
            scale: 1
          }).start();
          (0, _axios_connection.getroombyID)(rid).then(function (data) {
            if (data.data.Player1 == PlayerInfo.uid) {
              redchess.pauseSystemEvents(true);
              blackchess.pauseSystemEvents(true);
            }

            if (data.data.Player2 == PlayerInfo.uid) {
              redchess.pauseSystemEvents(true);
              blackchess.resumeSystemEvents(true);
            }
          });
          break;
        }
      }

      for (var k = 0; k < blackc.length; k++) {
        if (blackc[k].name == data.Name) {
          //move chess
          cc.tween(blackc[k]).delay(0.1).to(0.125, {
            position: cc.v2(data.Xed, data.Yed + 5),
            scale: 1.1
          }).delay(0.125).to(0.5, {
            position: cc.v2(data.X, data.Y + 15),
            scale: 1.3
          }, {
            easing: "backIn"
          }).delay(0.125).to(0.125, {
            position: cc.v2(data.X, data.Y),
            scale: 1
          }).start();
          (0, _axios_connection.getroombyID)(rid).then(function (data) {
            if (data.data.Player1 == PlayerInfo.uid) {
              redchess.resumeSystemEvents(true);
              blackchess.pauseSystemEvents(true);
            }

            if (data.data.Player2 == PlayerInfo.uid) {
              redchess.pauseSystemEvents(true);
              blackchess.pauseSystemEvents(true);
            }
          });
          break;
        }
      } // if (
      //   this.movelist.length == 0 ||
      //   this.movelist[this.movelist.length - 1] !==
      //     JSON.stringify(data[data.length - 1])
      // ) {
      //   this.movelist.push(JSON.stringify(data[data.length - 1]));
      // }
      // movecodelist.string = this.movelist;

    })["catch"](function () {
      console.log("Promise Rejected");
    });
    (0, _socket_connection.receiveddeadchess)().then(function (data) {
      for (var j = 0; j < redc.length; j++) {
        if (redc[j].name == data.name) {
          map.countreddead++; // redc[j].setScale(0.8, 0.8);

          cc.tween(redc[j]).delay(1).to(0, {
            position: cc.v2(187.5 - map.countreddead * map.chesssize, 0)
          }).call(function () {
            _this.node.pauseSystemEvents(true);

            _this.node.parent = deadredchess;
          }).start(); // redc[j].anchorX = 1;
          // redc[j].anchorY = 0.5;
          // redc[j].y = 0;
          // redc[j].x = 187.5 - map.countreddead * map.chesssize;
          // redc[j].pauseSystemEvents(true);
          // redc[j].parent = deadredchess;
        }
      }

      for (var k = 0; k < blackc.length; k++) {
        if (blackc[k].name == data.name) {
          map.countblackdead++;
          cc.tween(blackc[k]).delay(1).to(0, {
            position: cc.v2(-187.5 + map.countblackdead * map.chesssize, 0)
          }).call(function () {
            _this.node.pauseSystemEvents(true);

            _this.node.parent = deadblackchess;
          }).start(); // blackc[k].anchorX = 0;
          // blackc[k].anchorY = 0.5;
          // blackc[k].y = 0;
          // blackc[k].x = -187.5 + map.countblackdead * map.chesssize;
          // blackc[k].pauseSystemEvents(true);
          // blackc[k].parent = deadblackchess;
        }
      }
    })["catch"](function () {
      console.log("Promise Rejected");
    });
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0XFxib2FyZFxcdXBkYXRlLmpzIl0sIm5hbWVzIjpbImNjIiwiQ2xhc3MiLCJDb21wb25lbnQiLCJwcm9wZXJ0aWVzIiwibW92ZWNvZGVsaXN0IiwidHlwZSIsIkxhYmVsIiwicGxhY2UiLCJOb2RlIiwicmVkY2hlc3MiLCJibGFja2NoZXNzIiwiZGVhZHJlZGNoZXNzIiwiZGVhZGJsYWNrY2hlc3MiLCJtYXAiLCJtb3ZlbGlzdCIsInJpZCIsIm9uTG9hZCIsInN0YXJ0IiwidXBkYXRlIiwiZHQiLCJQbGF5ZXJJbmZvIiwiZGlyZWN0b3IiLCJnZXRTY2VuZSIsImdldENoaWxkQnlOYW1lIiwiZ2V0Q29tcG9uZW50IiwiUm9vbUluZm9zIiwicmVkYyIsImdldENoaWxkcmVuIiwiYmxhY2tjIiwidGhlbiIsImRhdGEiLCJjb25zb2xlIiwibG9nIiwiTmFtZSIsImoiLCJsZW5ndGgiLCJuYW1lIiwidHdlZW4iLCJkZWxheSIsInRvIiwicG9zaXRpb24iLCJ2MiIsIlhlZCIsIlllZCIsInNjYWxlIiwiWCIsIlkiLCJlYXNpbmciLCJQbGF5ZXIxIiwidWlkIiwicGF1c2VTeXN0ZW1FdmVudHMiLCJQbGF5ZXIyIiwicmVzdW1lU3lzdGVtRXZlbnRzIiwiayIsImNvdW50cmVkZGVhZCIsImNoZXNzc2l6ZSIsImNhbGwiLCJub2RlIiwicGFyZW50IiwiY291bnRibGFja2RlYWQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBT0FBLEVBQUUsQ0FBQ0MsS0FBSCxDQUFTO0FBQ1AsYUFBU0QsRUFBRSxDQUFDRSxTQURMO0FBR1BDLEVBQUFBLFVBQVUsRUFBRTtBQUNWQyxJQUFBQSxZQUFZLEVBQUU7QUFDWixpQkFBUyxJQURHO0FBRVpDLE1BQUFBLElBQUksRUFBRUwsRUFBRSxDQUFDTTtBQUZHLEtBREo7QUFLVkMsSUFBQUEsS0FBSyxFQUFFO0FBQ0wsaUJBQVMsSUFESjtBQUVMRixNQUFBQSxJQUFJLEVBQUVM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ZXRyb29tYnlJRCB9IGZyb20gXCIuLi9heGlvc19jb25uZWN0aW9uXCI7XHJcbmltcG9ydCB7XHJcbiAgcmVjZWl2ZWRjaGVzc1Bvc2l0aW9uLFxyXG4gIHJlY2VpdmVkZGVhZGNoZXNzLFxyXG4gIHJlY2VpdmVkcm9vbUlELFxyXG4gIHNlbmRjaGVzc1Bvc2l0aW9uLFxyXG59IGZyb20gXCIuLi9zb2NrZXRfY29ubmVjdGlvblwiO1xyXG5cclxuY2MuQ2xhc3Moe1xyXG4gIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgcHJvcGVydGllczoge1xyXG4gICAgbW92ZWNvZGVsaXN0OiB7XHJcbiAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgIHR5cGU6IGNjLkxhYmVsLFxyXG4gICAgfSxcclxuICAgIHBsYWNlOiB7XHJcbiAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgIHR5cGU6IGNjLk5vZGUsXHJcbiAgICB9LFxyXG4gICAgcmVkY2hlc3M6IHtcclxuICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgdHlwZTogY2MuTm9kZSxcclxuICAgIH0sXHJcbiAgICBibGFja2NoZXNzOiB7XHJcbiAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgIHR5cGU6IGNjLk5vZGUsXHJcbiAgICB9LFxyXG4gICAgZGVhZHJlZGNoZXNzOiB7XHJcbiAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgIHR5cGU6IGNjLk5vZGUsXHJcbiAgICB9LFxyXG4gICAgZGVhZGJsYWNrY2hlc3M6IHtcclxuICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgdHlwZTogY2MuTm9kZSxcclxuICAgIH0sXHJcbiAgICBtYXA6IHtcclxuICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgdHlwZTogY2MuTm9kZSxcclxuICAgIH0sXHJcbiAgICBtb3ZlbGlzdDogW10sXHJcbiAgICByaWQ6IHtcclxuICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgdHlwZTogY2MuTGFiZWwsXHJcbiAgICB9LFxyXG4gIH0sXHJcblxyXG4gIG9uTG9hZCgpIHt9LFxyXG4gIHN0YXJ0KCkge30sXHJcbiAgdXBkYXRlKGR0ID0gMTAwMDApIHtcclxuICAgIGxldCBQbGF5ZXJJbmZvID0gY2MuZGlyZWN0b3JcclxuICAgICAgLmdldFNjZW5lKClcclxuICAgICAgLmdldENoaWxkQnlOYW1lKFwiUGxheWVySW5mb1wiKVxyXG4gICAgICAuZ2V0Q29tcG9uZW50KFwiUGxheWVySW5mb1wiKTtcclxuICAgIGxldCBSb29tSW5mb3MgPSBjYy5kaXJlY3RvclxyXG4gICAgICAuZ2V0U2NlbmUoKVxyXG4gICAgICAuZ2V0Q2hpbGRCeU5hbWUoXCJSb29tSW5mb3NcIilcclxuICAgICAgLmdldENvbXBvbmVudChcIlJvb21JbmZvc1wiKTtcclxuICAgIHZhciByaWQgPSBSb29tSW5mb3MucmlkO1xyXG4gICAgdmFyIHJlZGNoZXNzID0gdGhpcy5yZWRjaGVzcztcclxuICAgIHZhciByZWRjID0gcmVkY2hlc3MuZ2V0Q2hpbGRyZW4oKTtcclxuICAgIHZhciBibGFja2NoZXNzID0gdGhpcy5ibGFja2NoZXNzO1xyXG4gICAgdmFyIGJsYWNrYyA9IGJsYWNrY2hlc3MuZ2V0Q2hpbGRyZW4oKTtcclxuICAgIGxldCBtYXAgPSB0aGlzLm1hcC5nZXRDb21wb25lbnQoXCJib2FyZGluZm9cIik7XHJcbiAgICBsZXQgZGVhZHJlZGNoZXNzID0gdGhpcy5kZWFkcmVkY2hlc3M7XHJcbiAgICBsZXQgZGVhZGJsYWNrY2hlc3MgPSB0aGlzLmRlYWRibGFja2NoZXNzO1xyXG4gICAgdmFyIG1vdmVjb2RlbGlzdCA9IHRoaXMubW92ZWNvZGVsaXN0O1xyXG5cclxuICAgIHJlY2VpdmVkY2hlc3NQb3NpdGlvbigpXHJcbiAgICAgIC50aGVuKChkYXRhKSA9PiB7IFxyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiZGF0YW5hbWVcIiArIGRhdGEuTmFtZSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCByZWRjLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgIHJlZGNbal0ubmFtZSA9PSBkYXRhLk5hbWVcclxuICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAvL21vdmUgY2hlc3NcclxuICAgICAgICAgICAgY2MudHdlZW4ocmVkY1tqXSlcclxuICAgICAgICAgICAgICAuZGVsYXkoMC4xKVxyXG4gICAgICAgICAgICAgIC50bygwLjEyNSwge1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IGNjLnYyKFxyXG4gICAgICAgICAgICAgICAgICBkYXRhLlhlZCxcclxuICAgICAgICAgICAgICAgICAgZGF0YS5ZZWQgKyA1XHJcbiAgICAgICAgICAgICAgICApLFxyXG4gICAgICAgICAgICAgICAgc2NhbGU6IDEuMSxcclxuICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgIC5kZWxheSgwLjEyNSlcclxuICAgICAgICAgICAgICAudG8oXHJcbiAgICAgICAgICAgICAgICAwLjUsXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBjYy52MihcclxuICAgICAgICAgICAgICAgICAgICBkYXRhLlgsXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5ZICsgMTVcclxuICAgICAgICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgICAgICAgc2NhbGU6IDEuMyxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB7IGVhc2luZzogXCJiYWNrSW5cIiB9XHJcbiAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgIC5kZWxheSgwLjEyNSlcclxuICAgICAgICAgICAgICAudG8oMC4xMjUsIHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBjYy52MihcclxuICAgICAgICAgICAgICAgICAgZGF0YS5YLFxyXG4gICAgICAgICAgICAgICAgICBkYXRhLlksXHJcbiAgICAgICAgICAgICAgICApLFxyXG4gICAgICAgICAgICAgICAgc2NhbGU6IDEsXHJcbiAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAuc3RhcnQoKTtcclxuXHJcbiAgICAgICAgICAgIGdldHJvb21ieUlEKHJpZCkudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICAgIGlmIChkYXRhLmRhdGEuUGxheWVyMSA9PSBQbGF5ZXJJbmZvLnVpZCkge1xyXG4gICAgICAgICAgICAgICAgcmVkY2hlc3MucGF1c2VTeXN0ZW1FdmVudHModHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICBibGFja2NoZXNzLnBhdXNlU3lzdGVtRXZlbnRzKHRydWUpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBpZiAoZGF0YS5kYXRhLlBsYXllcjIgPT0gUGxheWVySW5mby51aWQpIHtcclxuICAgICAgICAgICAgICAgIHJlZGNoZXNzLnBhdXNlU3lzdGVtRXZlbnRzKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgYmxhY2tjaGVzcy5yZXN1bWVTeXN0ZW1FdmVudHModHJ1ZSk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IGJsYWNrYy5sZW5ndGg7IGsrKykge1xyXG4gICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICBibGFja2Nba10ubmFtZSA9PSBkYXRhLk5hbWVcclxuICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAvL21vdmUgY2hlc3NcclxuICAgICAgICAgICAgY2MudHdlZW4oYmxhY2tjW2tdKVxyXG4gICAgICAgICAgICAgIC5kZWxheSgwLjEpXHJcbiAgICAgICAgICAgICAgLnRvKDAuMTI1LCB7XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogY2MudjIoXHJcbiAgICAgICAgICAgICAgICAgIGRhdGEuWGVkLFxyXG4gICAgICAgICAgICAgICAgICBkYXRhLlllZCArIDVcclxuICAgICAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgICAgICBzY2FsZTogMS4xLFxyXG4gICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgLmRlbGF5KDAuMTI1KVxyXG4gICAgICAgICAgICAgIC50byhcclxuICAgICAgICAgICAgICAgIDAuNSxcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgcG9zaXRpb246IGNjLnYyKFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuWCxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhLlkgKyAxNVxyXG4gICAgICAgICAgICAgICAgICApLFxyXG4gICAgICAgICAgICAgICAgICBzY2FsZTogMS4zLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHsgZWFzaW5nOiBcImJhY2tJblwiIH1cclxuICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgLmRlbGF5KDAuMTI1KVxyXG4gICAgICAgICAgICAgIC50bygwLjEyNSwge1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IGNjLnYyKFxyXG4gICAgICAgICAgICAgICAgICBkYXRhLlgsXHJcbiAgICAgICAgICAgICAgICAgIGRhdGEuWVxyXG4gICAgICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgICAgIHNjYWxlOiAxLFxyXG4gICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgLnN0YXJ0KCk7XHJcblxyXG4gICAgICAgICAgICBnZXRyb29tYnlJRChyaWQpLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgICBpZiAoZGF0YS5kYXRhLlBsYXllcjEgPT0gUGxheWVySW5mby51aWQpIHtcclxuICAgICAgICAgICAgICAgIHJlZGNoZXNzLnJlc3VtZVN5c3RlbUV2ZW50cyh0cnVlKTtcclxuICAgICAgICAgICAgICAgIGJsYWNrY2hlc3MucGF1c2VTeXN0ZW1FdmVudHModHJ1ZSk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIGlmIChkYXRhLmRhdGEuUGxheWVyMiA9PSBQbGF5ZXJJbmZvLnVpZCkge1xyXG4gICAgICAgICAgICAgICAgcmVkY2hlc3MucGF1c2VTeXN0ZW1FdmVudHModHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICBibGFja2NoZXNzLnBhdXNlU3lzdGVtRXZlbnRzKHRydWUpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gaWYgKFxyXG4gICAgICAgIC8vICAgdGhpcy5tb3ZlbGlzdC5sZW5ndGggPT0gMCB8fFxyXG4gICAgICAgIC8vICAgdGhpcy5tb3ZlbGlzdFt0aGlzLm1vdmVsaXN0Lmxlbmd0aCAtIDFdICE9PVxyXG4gICAgICAgIC8vICAgICBKU09OLnN0cmluZ2lmeShkYXRhW2RhdGEubGVuZ3RoIC0gMV0pXHJcbiAgICAgICAgLy8gKSB7XHJcbiAgICAgICAgLy8gICB0aGlzLm1vdmVsaXN0LnB1c2goSlNPTi5zdHJpbmdpZnkoZGF0YVtkYXRhLmxlbmd0aCAtIDFdKSk7XHJcbiAgICAgICAgLy8gfVxyXG4gICAgICAgIC8vIG1vdmVjb2RlbGlzdC5zdHJpbmcgPSB0aGlzLm1vdmVsaXN0O1xyXG5cclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIlByb21pc2UgUmVqZWN0ZWRcIik7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIHJlY2VpdmVkZGVhZGNoZXNzKClcclxuICAgICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHJlZGMubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgIGlmIChyZWRjW2pdLm5hbWUgPT0gZGF0YS5uYW1lKSB7XHJcbiAgICAgICAgICAgIG1hcC5jb3VudHJlZGRlYWQrKztcclxuICAgICAgICAgICAgLy8gcmVkY1tqXS5zZXRTY2FsZSgwLjgsIDAuOCk7XHJcbiAgICAgICAgICAgIGNjLnR3ZWVuKHJlZGNbal0pXHJcbiAgICAgICAgICAgICAgLmRlbGF5KDEpXHJcbiAgICAgICAgICAgICAgLnRvKDAsIHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBjYy52MigxODcuNSAtIG1hcC5jb3VudHJlZGRlYWQgKiBtYXAuY2hlc3NzaXplLCAwKSxcclxuICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgIC5jYWxsKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZS5wYXVzZVN5c3RlbUV2ZW50cyh0cnVlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZS5wYXJlbnQgPSBkZWFkcmVkY2hlc3M7XHJcbiAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAuc3RhcnQoKTtcclxuXHJcbiAgICAgICAgICAgIC8vIHJlZGNbal0uYW5jaG9yWCA9IDE7XHJcbiAgICAgICAgICAgIC8vIHJlZGNbal0uYW5jaG9yWSA9IDAuNTtcclxuICAgICAgICAgICAgLy8gcmVkY1tqXS55ID0gMDtcclxuICAgICAgICAgICAgLy8gcmVkY1tqXS54ID0gMTg3LjUgLSBtYXAuY291bnRyZWRkZWFkICogbWFwLmNoZXNzc2l6ZTtcclxuICAgICAgICAgICAgLy8gcmVkY1tqXS5wYXVzZVN5c3RlbUV2ZW50cyh0cnVlKTtcclxuICAgICAgICAgICAgLy8gcmVkY1tqXS5wYXJlbnQgPSBkZWFkcmVkY2hlc3M7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgYmxhY2tjLmxlbmd0aDsgaysrKSB7XHJcbiAgICAgICAgICBpZiAoYmxhY2tjW2tdLm5hbWUgPT0gZGF0YS5uYW1lKSB7XHJcbiAgICAgICAgICAgIG1hcC5jb3VudGJsYWNrZGVhZCsrO1xyXG4gICAgICAgICAgICBjYy50d2VlbihibGFja2Nba10pXHJcbiAgICAgICAgICAgICAgLmRlbGF5KDEpXHJcbiAgICAgICAgICAgICAgLnRvKDAsIHtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBjYy52MigtMTg3LjUgKyBtYXAuY291bnRibGFja2RlYWQgKiBtYXAuY2hlc3NzaXplLCAwKSxcclxuICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgIC5jYWxsKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZS5wYXVzZVN5c3RlbUV2ZW50cyh0cnVlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZS5wYXJlbnQgPSBkZWFkYmxhY2tjaGVzcztcclxuICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgIC5zdGFydCgpO1xyXG5cclxuICAgICAgICAgICAgLy8gYmxhY2tjW2tdLmFuY2hvclggPSAwO1xyXG4gICAgICAgICAgICAvLyBibGFja2Nba10uYW5jaG9yWSA9IDAuNTtcclxuICAgICAgICAgICAgLy8gYmxhY2tjW2tdLnkgPSAwO1xyXG4gICAgICAgICAgICAvLyBibGFja2Nba10ueCA9IC0xODcuNSArIG1hcC5jb3VudGJsYWNrZGVhZCAqIG1hcC5jaGVzc3NpemU7XHJcbiAgICAgICAgICAgIC8vIGJsYWNrY1trXS5wYXVzZVN5c3RlbUV2ZW50cyh0cnVlKTtcclxuICAgICAgICAgICAgLy8gYmxhY2tjW2tdLnBhcmVudCA9IGRlYWRibGFja2NoZXNzO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIlByb21pc2UgUmVqZWN0ZWRcIik7XHJcbiAgICAgIH0pO1xyXG4gIH0sXHJcbn0pO1xyXG4iXX0=