{"version":3,"sources":["assets\\script\\changescene\\backtoroomlist.js"],"names":["cc","Class","Component","properties","onLoad","backtoroomlist","PlayerInfo","director","getScene","getChildByName","getComponent","RoomInfos","roomID","rid","fetch","method","headers","Accept","then","response","json","data","console","log","Player1","Player2","uid","p2","body","JSON","stringify","loadScene","start","onDisable"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport { receivedroomID } from \"../socket_connection\";\r\n\r\ncc.Class({\r\n  extends: cc.Component,\r\n\r\n  properties: {},\r\n  onLoad() {},\r\n  backtoroomlist() {\r\n    var PlayerInfo = cc.director\r\n      .getScene()\r\n      .getChildByName(\"PlayerInfo\")\r\n      .getComponent(\"PlayerInfo\");\r\n    var RoomInfos = cc.director\r\n      .getScene()\r\n      .getChildByName(\"RoomInfos\")\r\n      .getComponent(\"RoomInfos\");\r\n\r\n    let roomID = RoomInfos.rid;\r\n    fetch(\"https://chinese-chess-vnp.herokuapp.com/api/room/\" + roomID, {\r\n      method: \"GET\",\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n    })\r\n      .then((response) => response.json())\r\n      .then((data) => {\r\n        console.log(data);\r\n        if (data.data.Player1 != null && data.data.Player2 != null) {\r\n          if (data.data.Player1 == PlayerInfo.uid) {\r\n            let p2 = data.data.Player2;\r\n            fetch(\r\n              \"https://chinese-chess-vnp.herokuapp.com/api/room/\" + roomID,\r\n              {\r\n                method: \"PATCH\",\r\n                headers: {\r\n                  Accept: \"application/json\",\r\n                  \"Content-Type\": \"application/json\",\r\n                },\r\n                body: JSON.stringify({ Player1: p2, Player2: null }),\r\n              }\r\n            )\r\n              .then((response) => response.json())\r\n              .then((data) => {\r\n                console.log(data);\r\n                RoomInfos.rid = null;\r\n                cc.director.loadScene(\"rooms\");\r\n              });\r\n          }\r\n          if (data.data.Player2 == PlayerInfo.uid) {\r\n            fetch(\r\n              \"https://chinese-chess-vnp.herokuapp.com/api/room/\" + roomID,\r\n              {\r\n                method: \"PATCH\",\r\n                headers: {\r\n                  Accept: \"application/json\",\r\n                  \"Content-Type\": \"application/json\",\r\n                },\r\n                body: JSON.stringify({ Player2: null }),\r\n              }\r\n            )\r\n              .then((response) => response.json())\r\n              .then((data) => {\r\n                console.log(data);\r\n                RoomInfos.rid = null;\r\n                cc.director.loadScene(\"rooms\");\r\n              });\r\n          }\r\n        }\r\n        if (data.data.Player1 == null && data.data.Player2 != null) {\r\n          fetch(\"https://chinese-chess-vnp.herokuapp.com/api/room/\" + roomID, {\r\n            method: \"PATCH\",\r\n            headers: {\r\n              Accept: \"application/json\",\r\n              \"Content-Type\": \"application/json\",\r\n            },\r\n            body: JSON.stringify({ Player2: null }),\r\n          })\r\n            .then((response) => response.json())\r\n            .then((data) => {\r\n              console.log(data);\r\n              RoomInfos.rid = null;\r\n              cc.director.loadScene(\"rooms\");\r\n            });\r\n        }\r\n        if (data.data.Player1 != null && data.data.Player2 == null) {\r\n          fetch(\"https://chinese-chess-vnp.herokuapp.com/api/room/\" + roomID, {\r\n            method: \"PATCH\",\r\n            headers: {\r\n              Accept: \"application/json\",\r\n              \"Content-Type\": \"application/json\",\r\n            },\r\n            body: JSON.stringify({ Player1: null }),\r\n          })\r\n            .then((response) => response.json())\r\n            .then((data) => {\r\n              console.log(data);\r\n              RoomInfos.rid = null;\r\n              cc.director.loadScene(\"rooms\");\r\n            });\r\n        }\r\n      });\r\n  },\r\n  start() {},\r\n  onDisable() {},\r\n  // update (dt) {},\r\n});\r\n"]}